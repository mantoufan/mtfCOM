!function(){"use strict";function a(){}function b(a,b,c){return function(){var e,d=arguments;if("function"==typeof c){try{e=c.apply(a,d)}catch(f){return a.reject(f),void 0}if(e&&"function"==typeof e.then)return e.done&&e.fail?e.done(a.resolve).fail(a.reject):e.then(a.resolve,a.reject),void 0;d=[e],b="resolve"}a[b].apply(a,d)}}var c=function(d){function f(a){return function(){if(e)return j;g=arguments,e=!0,j.done=j.fail=j.resolve=j.reject=function(){return j},j[a?"done":"fail"]=function(a){return"function"==typeof a&&a.apply(j,g),j};for(var b,c=a?h:i,d=0,f=c.length;f>d;d++)b=c[d],"function"==typeof b&&b.apply(j,g);return c=h=i=null,j}}var g,e=!1,h=[],i=[],j={done:function(a){return h.push(a),j},fail:function(a){return i.push(a),j},then:function(a,d){var e=c();return j.done(b(e,"resolve",a)).fail(b(e,"reject",d)),e},notify:a,progress:a,promise:function(){return j},always:function(a){return j.done(a).fail(a)},resolve:f(!0),reject:f(!1)};if(j["catch"]=function(a){return j.then(null,a)},"function"==typeof d)try{d(j.resolve,j.reject)}catch(k){j.reject(k)}return j};c.all=function(a){var d,i,b=c(),e=0,f=a.length,g=f,h=[],j=function(a,c){a>=0&&(h[a]=c),--g<=0&&b.resolve(h)},k=function(a){b.reject([a])};if(0===g)j();else for(;f>e;e++)d=a[e],d&&"function"==typeof d.then?(i=j.bind(null,e),d.done&&d.fail?d.done(i).fail(k):d.then(i,k)):j(e,d);return b},c.race=function(a){return c.all(a).then(function(a){return a.pop()})},c.cast=function(a){var b=c().resolve(a);return a&&"function"==typeof a.then?b.then(function(){return a}):b},c.resolve=function(a){return c().resolve(a)},c.reject=function(a){return c().reject(a)},c.map=function(a){var d,b=[],e=0,f={};for(d in a)b.push(a[d]);return c.all(b).then(function(b){for(d in a)f[d]=b[e++];return f})},c.version="0.2.1","function"==typeof define&&(define.amd||define.ajs)?define("Promise",[],function(){return c}):"undefined"!=typeof module&&module.exports?module.exports=c:(window.Deferred=c,window.Promise||(window.Promise=c))}();